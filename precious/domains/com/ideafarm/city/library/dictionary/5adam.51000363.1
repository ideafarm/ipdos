
//
// Copyright (c) 1992-2019 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 25 years.
// Respecting the rights of other people is an important part of empowering one another.
//


REST
etThread.osProcessIdPhaseAdamF( tinP , ifcIDpHASEhANDOFFoLD_SHUTTINGdOWN ) ;

#endif

etThread.delF( tinP , pbImage ) ;

}
    }
        //U: CONJ: LEAK pso
        }
            { ZE( countT , tid ) ; etThread.osThreadF( tinP , tid , tmServeF , 0 , flTHREADlAUNCH_null , 0 , (countT)pso , (countT)pbImage , cbImage ) ; }
        {
        if( pso && !ether )
        //etThread.strokeF( tinP , tX ) ;
        etThread.strokeF( tinP , T("\r")+TF1(++idClient) ) ;

        sock.acceptF( tinP , pso , idPortPeer , nnPeer , countTC() ) ;
        ZE( countT , idPortPeer ) ;
        nicNameC nnPeer ;
        ZE( socketC* , pso ) ;
    {
    while( !ether && !etThread )
    //TN( tX , "X" ) ;
    ZE( countT , idClient ) ;
    sock.listenF( tinP ) ;
    sock.bindF( tinP , 8004 ) ;
    socketC sock( tinP , etThread , TAG( TAGiDnULL ) ) ;
{
if( !ether )

etThread.boxGetShadowF( tinP , pbImage , cbImage , T("///d/tmp/globe.gif") ) ; ___( pbImage ) ;
ZE( countT , cbImage ) ;
ZE( byteT* , pbImage ) ;

LAUNCHhEAReNTER( tmHearEnterF , 8004 ) ;

etThread.strokeF( tinP , T("MediaPlex Http Server\r\n\r\npress the Enter key to fire me\r\n\r\n") ) ;

#if defined( NEVERdEFINED )

TODO

DONE( tmServeF )
}
    DEL( pso ) ;

    etThread = 0 ;
    etThread.delF( tinP , posti ) ;
    pso->readF( tinP , posti , CBpOSTI ) ;
    etThread.newF( tinP , LF , posti , CBpOSTI ) ; ___( posti ) ;
    ZE( osTextT* , posti ) ;

    etThread.delF( tinP , psttOldCmd ) ;

    else if( !etThread.strCompareF( tinP , psttOldCmd , T("click") ) ) pso->writeF( tinP , (osTextT*)tClickReply ) ;
    }
        pso->writeF( tinP , pbImage , cbImage ) ;
        pso->writeF( tinP , (osTextT*)txt ) ;
        textC txt = T("HTTP/1.0 200\r\nContent-Type: image/gif\r\nContent-Length: ")+TF4(cbImage,0,0,0xa)+T("\r\n\r\n") ;
    {
    else if( !etThread.strCompareF( tinP , psttOldCmd , T("image") ) )
    }
        pso->writeF( tinP , (osTextT*)txt ) ;
        textC txt = T("HTTP/1.0 200\r\nContent-Type: text/html\r\nContent-Length: ")+TF4(tFace.csF(tinP),0,0,0xa)+T("\r\n\r\n")+tFace ;
    {
    if( !etThread.strCompareF( tinP , psttOldCmd , T("face") ) )

    static TN( tClickReply , "HTTP/1.0 302\r\nLocation: http://www.ideafarm.com/\r\n\r\n" ) ;
    static TN( tFace       , "<A HREF=\"http://city.center.ideafarm.com:8004/click\"><IMG HEIGHT=\"60\" WIDTH=\"60\" SRC=\"http://city.center.ideafarm.com:8004/image\"></A>" ) ;

    }
        //etThread.strokeF( tinP , T("\"")+T(psttOldCmd)+T("\"\r\n") ) ;
        etThread.delF( tinP , psttw ) ;
        etThread.strSubstringF( tinP , psttOldCmd , idf , idl , psttw ) ;
        ZE( countT , idl ) ;
        countT idf = 2 ;
        etThread.delF( tinP , psttl ) ;
        etThread.strWordF( tinP , psttw , psttl , sttq , S1C(' ') , 2 ) ;
        strokeS sttq( (countT)0 , sc_IGNOREqUOTES ) ;
        ZE( strokeS* , psttw ) ;
        pso->readWoLineF( tinP , psttl , 0x1000 ) ;
        ZE( strokeS* , psttl ) ;
    {
    ZE( strokeS* , psttOldCmd ) ;

    pso->etherF( tinP , etThread ) ;
    countT   cbImage =           pTaskP->c3 ;
    byteT*   pbImage = (byteT*)  pTaskP->c2 ;
    socketC* pso     = (socketC*)pTaskP->c1 ;
{
if( pTaskP && pTaskP->c1 && pTaskP->c2 )
TASK( tmServeF )

#define CBpOSTI 0x10000

tmHEAReNTER( tmHearEnterF )

/*1*/WAKEhIDE( "mediaplex.http.server.globe" )/*1*/
/**/
*/
quits after one service
serves a constant page (ignores the parameter to GET)
listens to port 8004_9
http server
mediaplex
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 25 years.
//
// Copyright (c) 1992-2019 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

