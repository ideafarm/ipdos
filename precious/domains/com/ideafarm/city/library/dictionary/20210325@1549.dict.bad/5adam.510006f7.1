
//
// Copyright (c) 1992-2021 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 29 years.
// Respecting the rights of other people is an important part of empowering one another.
//


REST

etThread.traceF( tinP , T("ok") ) ;

etThread.delF( tinP , posti ) ;
DEL( pfo ) ;
if( offi && pfo ) etThread.fileWriteF( tinP , *pfo , posti , offi ) ;

}
    }
        else offi = 0 ;
        }
            offi = offt ;
            etThread.memCopyF( tinP , posti , postt , offt ) ;                                                  // MOVE UNWRITTEN PARTIAL TOKEN TO BEGINNING OF INPUT BUFFER
        {
        if( offt )                                                                                          // IF PARTIAL TOKEN
        etThread.fileWriteF( tinP , *pfo , posti , offi - offt ) ;                                          // FLUSH BUFFER EXCLUDING ANY PARTIAL TERMINATING TOKEN
    {
    if( offi == costai )

    }
        else if( bArmed ) bArmed = 0 ;
        if( posti[ offi - 1 ] == '\n' ) bArmed = 1 ;
        if( offt ) offt = 0 ;
    {
    else
    }
        }
            etThread.traceF( tinP , TF3(idFileLath,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,8) ) ;
            pfo = new( 0 , tinP , LF ) fileC( tinP , (strokeS*)( T("///d/tmp/gmail.download/1.separated/mail.")+TF3(++idFileLath,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,8)+T(".eml") ) , ifcOPENaCCESS_W , 0 , flOPENdETAILS_LOCsEQ , ifcOPENhOW_nCeR ) ; ___( pfo ) ;
            DEL( pfo ) ;                                                                                        // CLOSE THE OUTPUT FILE AND OPEN THE NEXT OUTPUT FILE

            offt = 0 ;
            offi = offt ;
            etThread.memCopyF( tinP , posti , postt , offt ) ;                                                  // MOVE UNWRITTEN TOKEN TO BEGINNING OF INPUT BUFFER
            etThread.fileWriteF( tinP , *pfo , posti , offi - offt ) ;                                          // FLUSH BUFFER EXCLUDING TERMINATING TOKEN
        {
        if( ++ offt == sizeof postt - 1 && offt < offi )                                                    // IF WHOLE TOKEN MATCH AND AM NOT AT BEGINNING OF INPUT

        if( !offt ) bArmed = 0 ;
    {
    if( posti[ offi - 1 ] == postt[ offt ] && ( bArmed || offt ) )                                      // IF CHAR MATCH
    
    }
        break ;
        etThread.traceF( tinP , T("eof reached") ) ;
    {
    if( !cba )

    etThread.fileReadF( tinP , posti + ( offi ++ ) , cba , fi , 1 ) ;
    countT cba = 1 ;
{
while( !ether && !POOP )
ZE( boolT , bArmed ) ;                                                                              // ARMED MEANS WILL RECOGNIZE WOTH TEST CHARACTER.  ARMED ONLY IMMEDIATELY AFTER LF HAS BEEN READ; INTENTIONALLY DISARMED FOR BEGINNING OF FILE

ZE( countT , offt ) ;
osTextT postt[] = "From " ;

__Z( posti ) ;
etThread.newF( tinP , LF , posti , costai ) ; ___( posti ) ;
const countT costai = TOCK ;
ZE( countT , offi ) ;
ZE( osTextT* , posti ) ;

fileC fi( tinP , (strokeS*)T("///d/tmp/gmail.download/gmail.mbox") ) ;

etThread.traceF( tinP , TF3(idFileLath,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,8) ) ;
fileC* pfo = new( 0 , tinP , LF ) fileC( tinP , (strokeS*)( T("///d/tmp/gmail.download/1.separated/mail.")+TF3(++idFileLath,flFORMAT_NObIGITvALUES|flFORMAT_UNSIGNED|flFORMAT_FOREIGN|flFORMAT_FILLzE,8)+T(".eml") ) , ifcOPENaCCESS_W , 0 , flOPENdETAILS_LOCsEQ , ifcOPENhOW_nCeR ) ; ___( pfo ) ;
ZE( countT , idFileLath ) ;

TODO

// WHEN I HAVE A MATCH OR MY BUFFER IS FULL, I FLUSH THE BUFFER
// I READ INTO A BUFFER WO CHAR AT A TIME, TESTING FOR A MATCH
// 
// RECIPE


/*1*/WAKEsHOWtEXT( "tool.mbox.file.1.break.into.separate.file.for.each.item" )/*1*/
/**/
*/
i just look for "\r\nfrom " and divide the input file into separate output files beginning with that string
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 29 years.
//
// Copyright (c) 1992-2021 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

