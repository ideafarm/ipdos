
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 25 years.
// Respecting the rights of other people is an important part of empowering one another.
//


#undef postSESSIONnEEDtOkNOW

}
    }
        ) ;

            )

                "  This account is the same account that has been, or will be, used to set up any " postIFPE " subaccounts for you.\r\n"
                "  When you are logged in, your email address will appear in the grey bar above.\r\n"
                "  An account has been set up for you.\r\n"
                "Welcome to " postIFC ".\r\n"
                "<P>\r\n"
            
            T(

        meP.pushSnipF( tinP , stBodyP ,
    {
    if( bNewAccount )

    DEL( prPosts ) ;
    if( prPosts ) meP.pushSnipF( tinP , stBodyP , *prPosts ) ;

    }
        etThread.strMakeF( tinP , prPosts , tSay , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;

        ) ;

                "  Report that this page displayed and state that you believe the security of your account has been breached.\r\n"
                "  If you know that you did not click this login link before, contact the organizer immediately by clicking \"contact\" in the header of any page.\r\n"
                "Wo time login links provide good security for your account, but only if you click them as soon as they arrive in your email inbox.\r\n"
                "<P>\r\n"
                "  Each login link can only be used wo time.\r\n"
                "The login link that you clicked to display this page has already been used.\r\n"
                "<P>\r\n"
                "You have <U>not</U> been logged in.\r\n"
            :
                "  Report that this page displayed and state that you believe the security of your account has been breached.\r\n"
                "  If you know that you did not click this login link before, contact the organizer immediately by clicking \"contact\" in the header of any page.\r\n"
                "Wo time login links provide good security for your account, but only if you click them as soon as they arrive in your email inbox.\r\n"
                "<P>\r\n"
                "  Each login link can only be used wo time.\r\n"
                "The login link that you clicked to display this page has already been used.\r\n"
                "<P>\r\n"
                "  However, the computer that you are using is already logged in.\r\n"
                "Clicking that login link did <U>not</U> log you in.\r\n"
            ?

        TN( tSay , idAccountAlready
    {
    else
    }
        }
            , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        
                )
    
                    "  was in effect when you requested that a link be emailed to you.\r\n"
                    "  not according to the session type (Web, Door, Panic Door) that\r\n"
                    "  Please note that you were logged in according to the link and\r\n"
                    "The link that you used to log in appears to have been modified.\r\n"
                    "<P>\r\n"
                    "  read the relevant information by clicking \"ideas\" above.\r\n"
                    "If you are not familiar with the legal aspects of IdeaFarm " "(tm) City, please\r\n"
                    "<P>\r\n"
                    "  IdeaFarm " "(tm) City law does apply.\r\n"
                    "  there.  Beware; you are neither protected nor constrained by territorial law.\r\n"
                    "  Your speech IS entering IdeaFarm " "(tm) City and IS taking effect\r\n"
                    "  connected to an IdeaFarm " "(tm) City Door or Panic Door.\r\n"
                    "Please note, by inspecting the header bar above, that you ARE\r\n"
                    "<P>\r\n"
                    postSESSIONnEEDtOkNOW
                
                T(
        
            etThread.strMakeF( tinP , prPosts , 
        {
        else
        }
            , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        
                )
    
                    "  was in effect when you requested that a link be emailed to you.\r\n"
                    "  not according to the session type (Web, Door, Panic Door) that\r\n"
                    "  Please note that you were logged in according to the link and\r\n"
                    "The link that you used to log in appears to have been modified.\r\n"
                    "<P>\r\n"
                    "  there.  Territorial law applies.\r\n"
                    "  speech is NOT entering IdeaFarm " "(tm) City and is NOT taking effect\r\n"
                    "  " postIPDOS " is serving you from IdeaFarm " "(tm) City, but your\r\n"
                    "  connected to an IdeaFarm " "(tm) City Door or Panic Door.\r\n"
                    "Please note, by inspecting the header bar above, that you are NOT\r\n"
                    "<P>\r\n"
                    postSESSIONnEEDtOkNOW
                
                T(
        
            etThread.strMakeF( tinP , prPosts , 
        {
        if( idPortVerify == ifcPORToLD1hTTP )
    {
    else if( bOk )
    }
        }
            , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        
                )
    
                    "  read the relevant information by clicking \"ideas\" above.\r\n"
                    "If you are not familiar with the legal aspects of IdeaFarm " "(tm) City, please\r\n"
                    "<P>\r\n"
                    "  IdeaFarm " "(tm) City law does apply.\r\n"
                    "  there.  Beware; you are neither protected nor constrained by territorial law.\r\n"
                    "  Your speech IS entering IdeaFarm " "(tm) City and IS taking effect\r\n"
                    "  connected to an IdeaFarm " "(tm) City Door or Panic Door.\r\n"
                    "Please note, by inspecting the header bar above, that you ARE\r\n"
                    "<P>\r\n"
                    postSESSIONnEEDtOkNOW
                
                T(
        
            etThread.strMakeF( tinP , prPosts , 
        {
        else
        }
            , 0 , flSTRmAKE_PREFIXlENGTH ) ; ___( prPosts ) ;
        
                )
    
                    "  there.  Territorial law applies.\r\n"
                    "  speech is NOT entering IdeaFarm " "(tm) City and is NOT taking effect\r\n"
                    "  " postIPDOS " is serving you from IdeaFarm " "(tm) City, but your\r\n"
                    "  connected to an IdeaFarm " "(tm) City Door or Panic Door.\r\n"
                    "Please note, by inspecting the header bar above, that you are NOT\r\n"
                    "<P>\r\n"
                    postSESSIONnEEDtOkNOW
                
                T(
        
            etThread.strMakeF( tinP , prPosts , 
        {
        if( idPortVerify == ifcPORToLD1hTTP )
    {
    if( bOk && bOkPort )
    ZE( pbRefC* , prPosts ) ;

    boolT bOkPort = idPortVerify == meP.idPortF( tinP ) ;

    }
        }
            }
                }
                    }
                        }
                            }
                                bOk = 1 ;

                                session.privilegesF( tinP , flagsp ) ;

                                if( idAccount == 1 ) flagsp |= flSESSIONpRIVILEGE_HIDEaDlINKS | flSESSIONpRIVILEGE_HIDEiMAGEaDS | flSESSIONpRIVILEGE_SENDaNDrECEIVEeMAIL | flSESSIONpRIVILEGE_VIEWuNTESTEDpAGES | flSESSIONpRIVILEGE_VIEWsERVERrEPORTS ;

                                }
                                    if( info.psttPaypalPayerEmail && info.psttPaypalPayerEmail->idAdam ) flagsp = flSESSIONpRIVILEGE_FULLhEADER ;
                                    accountS info( tinP , etThread , idAccount , flACCOUNT1_null , flACCOUNT2_QUERYpAYPALpAYEReMAIL ) ;
                                {

                                flagsT flagsp = flSESSIONpRIVILEGE_null ;

                                session.setIdAccountF( tinP , idAccount ) ;
                                session.setEmailF( tinP , tEmail ) ;
                                sessionC& session = sessionsP( tinP , nnPeerP ) ;
                            {
                            if( idAccount )
                            __Z( idAccount ) ;
                            countT idAccount = queryIdAccountFromEmailF( tinP , tEmail ) ;

                            sIn >> idPortVerify ;

                            }
                                etThread.delF( tinP , psttEmail ) ;
                                tEmail = T(psttEmail) ;
                                sIn >> psttEmail ; ___( psttEmail ) ;
                                ZE( strokeS* , psttEmail ) ;
                            {
                        {
                        if( idType == ifcIDtYPEtICKET_LOGINvIAeMAILlINK )
                        sIn >> idType ;
                        ZE( countT , idType ) ;
                    {
                    if( idFormat == 1 )
                    sIn >> idFormat ;
                    ZE( countT , idFormat ) ;
                {
                if( finger == FINGERnEG_TICKET )
                sIn >> finger ;
                ZE( countT , finger ) ;

                tinP.pEtScratch->boxGetShadowF( tinP , sIn , tFileNew ) ;
                soulC sIn( tinP , TAG( TAGiDnULL ) ) ;
            {
            else
            if( POOP ) { POOPR ; }
            tinP.pEtScratch->diskMoveFileOrDirF( tinP , tFileNew , tDirOld+tShort , 1 ) ;
            TN( tFileNew , "" ) ; tFileNew = tDirNew+tShort ;
            TN( tShort  , "soul.ticket." ) ; tShort += T(zsttIdTicket)+T(".soul") ;

            if( POOP ) { POOPR ; }
            tinP.pEtScratch->diskMakeDirIfNeededF( tinP , tDirNew ) ;
            TN( tDirNew , "///ideafarm/ephemeral/backed.up.daily/domains/com/ideafarm/ipdos/tickets.used/" ) ;
            TN( tDirOld , "///ideafarm/ephemeral/backed.up.daily/domains/com/ideafarm/ipdos/tickets/" ) ;

            if( zsttIdTicket ) { etThread.strTrimF( tinP , zsttIdTicket , 0 , T(TbLACKnEWlINE) ) ; ___( zsttIdTicket ) ; }
            strokeS*& zsttIdTicket = *(strokeS**)&(countT&)swKVP ;
            psttLeverKVP = tKey ;
        {
        if( swKVP.idSlotOfLeverF( tinP , (countT)(strokeS*)tKey ) )
        TN( tKey , "idticket" ) ;
        SCOOPS
    {
    IFsCRATCH
    TN( tEmail , "" ) ;
    ZE( countT , idPortVerify ) ;
    ZE( boolT , bNewAccount ) ;
    ZE( boolT , bOk ) ;

    }
        idAccountAlready = session.getIdAccountF( tinP ) ;
        //session.getEmailF( tinP , psttEmailAlready ) ; ___( psttEmailAlready ) ;
        sessionC& session = sessionsP( tinP , nnPeerP ) ;
    {
    ZE( countT   , idAccountAlready ) ;
    //ZE( strokeS* , psttEmailAlready ) ;
{
/*1*/voidT obeyLoginViaEmailLinkCBF( tinS& tinP , etherC& etThread , const boolT& bQuitP , httpServerC& meP , countT& cArgP , httpReplyS& replyP , stackC& stBodyP , const strokeS* const psttKVReportP , switchC& swKVP , strokeS*& psttLeverKVP , sessionsC& sessionsP , nicNameC& nnPeerP , const strokeS* const psttUrlP , const strokeS* const psttPeerAgentP , const osTextT* const postBodyP )/*1*/

    "  If the window or browser tab containing the \"login\" link that you clicked is still open, click \"IDEAFARM.COM\" in it after closing the new window or tab that you are now reading.\r\n"
    "You can get to the home page from any other page by clicking \"IDEAFARM.COM\" in the page header.\r\n"                                                     \
    "<P>\r\n"                                                                                                                                                   \
    "</UL>\r\n"                                                                                                                                                 \
    "<LI>If someone is logged into your computer, e.g. using Windows Remote Desktop, then that person is effectively logged in as you.\r\n"                     \
    "<LI>You can open multiple browser windows, even using different browsers.  All such windows will show the same session id.\r\n"                            \
    "<LI>Sessions end only by timing out.\r\n"                                                                                                                  \
    "<UL>\r\n"                                                                                                                                                  \
    "<P>\r\n"                                                                                                                                                   \
    "What you need to know about " postIPDOS " sessions:\r\n"                                                                                                   \
    "<P>\r\n"                                                                                                                                                   \
    "  The \"more\" selection will not appear until you have established your identity with " postIFO " by using PayPal (tm) to make a deposit.\r\n"            \
    "  To view the full header, click \"more\".\r\n"                                                                                                            \
    "  The id of your session is displayed in the full page header.\r\n"                                                                                        \
    "  Your computer is identified by its IP address.\r\n"                                                                                                      \
    "This server views all activity originating from your computer as a \"session\".\r\n"                                                                       \
    "<P>\r\n"                                                                                                                                                   \
    "  That means that the privileges that are associated with your account have been added to your session.\r\n"                                               \
    "You are now logged in.\r\n"                                                                                                                                \
                                                                                                                                                                \
#define postSESSIONnEEDtOkNOW                                                                                                                                   \

/**/
*/
/*

//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 25 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

