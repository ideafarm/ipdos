//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\1snip.1a000002.includeGenMake.base.hide.third : 1snip.1a000002.includegenmake.base.hide.third BEGIN
#define DDNAME       "1snip.1a000002.includegenmake.base.hide.third"
#define DDNUMB      (countT)0x1a000002
#define IDFILE      (countT)0x86a


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
\<A HREF=\"5.005f002.1.0.html\"\>definition\</A\>
it is illegal to refer to this symbol in the definition of an adam
*/
/**/
/*1*//*this includes the base hide flavor of ipdos.h*//*1*/
#include "\ideafarm.home.1\precious\domains\com\ideafarm\city\library\snip\ipdos.base.hide.third.1.h"
#include "\ideafarm.home.1\precious\domains\com\ideafarm\city\library\snip\ipdos.base.hide.third.2.h"


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\1snip.1a000002.includeGenMake.base.hide.third : 1snip.1a000002.includegenmake.base.hide.third END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef001.basegrabc.dt_basegrabc BEGIN
#define DDNAME       "3func.360ef001.basegrabc.dt_basegrabc"
#define DDNUMB      (countT)0x360ef001
#define IDFILE      (countT)0x143f


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/
/*1*/baseGrabC::~baseGrabC( voidT )/*1*/
{
    if( getNegAM( finger ) != FINGERnEG_BASEgRABc ) { BLAMMO ; }
    putNegAM( finger , FINGERnEG_BASEgRABczOMBIE ) ;
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef001.basegrabc.dt_basegrabc END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef002.basegrabc.basegrabc BEGIN
#define DDNAME       "3func.360ef002.basegrabc.basegrabc"
#define DDNUMB      (countT)0x360ef002
#define IDFILE      (countT)0x1440


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/

/*1*/baseGrabC::baseGrabC( tinS& tinP , const countT idLineCtP , const countT idiFileCtP , const countT idTypeP , const flagsT flagsP , const countT idGrabLayerP )/*1*/
{
    SCOOP

    if( !( F(flagsP) & flBASEgRABc_EXPLICITfORMATTING ) ) formatF( tinP , idLineCtP , idiFileCtP , idTypeP , flagsP , idGrabLayerP ) ;
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef002.basegrabc.basegrabc END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef003.basegrabc.formatf BEGIN
#define DDNAME       "3func.360ef003.basegrabc.formatf"
#define DDNUMB      (countT)0x360ef003
#define IDFILE      (countT)0x1441


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/

/*1*/voidT baseGrabC::formatF( tinS& tinP , const countT idLineCtP , const countT idiFileCtP , const countT idTypeP , const flagsT flagsP , const countT idGrabLayerP )/*1*/
{
    new( 0 , tinP , (byteT*)&poop , sizeof poop ) poopC ;

    idTypeCt    = idTypeP ;
    flagsCt     = flagsP ;
    idLineCt    = idLineCtP ;
    idiFileCt   = idiFileCtP ;
    idThreadCt  = tinP.monitor.idThread ;
    idGrabLayer = idGrabLayerP ;
    idiFileGrabberNote = idLineGrabberNote = idiFileGrabber = idLineGrabber = 0 ;
    putNegAM( finger , FINGERnEG_BASEgRABc ) ;
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef003.basegrabc.formatf END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef004.basegrabc.registerbegunf BEGIN
#define DDNAME       "3func.360ef004.basegrabc.registerbegunf"
#define DDNUMB      (countT)0x360ef004
#define IDFILE      (countT)0x1442


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/
/*1*/voidT baseGrabC::registerBegunF( tinS& tinP , const countT idLineP , const countT idiFileP , const flagsT flagsP )/*1*/
{
    SCOOP

    _IO_

    const countT pandle = idTypeCt == ifcIDtYPEdERIVEDbASEgRABc_grabC
        ? (countT)this
        : ( (countT)&(byteT&)*(grabitC*)this ) | BM_HIGH
    ;

    //TO FIND A BUG
    //if( !( pandle & BM_HIGH ) && !( F(this->flagsCt) & flBASEgRABc_NOTjEALOUS ) && idLineP == 9162 && idiFileP == 0x33000065 )
    //{
    //    countT foo = 2 ;
    //}

    if( !( F(flagsCt) & flBASEgRABc_DOnOTrEGISTER ) )
    {
        tinP.monitor.pPanLifiGrabbing[ 2 ] = idiFileP ;
        tinP.monitor.pPanLifiGrabbing[ 1 ] = idLineP  ;
        tinP.monitor.pPanLifiGrabbing[ 0 ] = pandle ;
    }

    if( !( F(flagsP) & flBASEgRABcrEGISTERbEGUN_RECURSING ) )
    {
        //BLAMMO IF CALLING THREAD IS GRABBING BACKWARDS IN THE GRAB OBJECT SEQUENCE ; THE SET OF ALL GRAB OBJECTS IS WEAKLY ORDERED, AS CAN BE SEEN BY INSPECTING THIS CODE
        boolT bOnlyWo = F(processGlobal1I._thirdC_flagsModeProcess2) & flMODEpROCESS2_GRABoNLYwO || F(tinP.flagsThreadMode3) & flTHREADmODE3_GRABoNLYwO ;
        for( countT offi = 0 ; offi < sizeof tinP.pPanLifiRecurseGrabbedLevel / sizeof tinP.pPanLifiRecurseGrabbedLevel[ 0 ] ; offi += 5 )
        {
            if( tinP.pPanLifiRecurseGrabbedLevel[ offi ] && tinP.pPanLifiRecurseGrabbedLevel[ offi ] != pandle )
            {
                //20151117@1242: ADDED TO BLAMMO IF I AM BEGIN GRABBED BY A THREAD THAT ALREADY HOLDS A JEALOUS OTHER
                // THE CONCEPT OF JEALOUSY ALLOWS APPLICATION CODE TO AVOID DEADLOCKS BY FORCING APP CODE TO EXPLICITLY CONSTRUCT grabC INSTANCES AS NONjEALOUS
                // grabC INSTANCES ARE JEALOUS BY DEFAULT, WHICH MEANS THAT THEY, WHILE GRABBED, WILL NOT ALLOW THE THREAD TO GRAB ANOTHER WO
                // "SNEAKY LOVERS" CAN GRAB WITHOUT TRIGGERING JEALOUSY

                if
                (
                    !( F(flagsCt) & flBASEgRABc_SNEAKYlOVER )
                    && !( tinP.pPanLifiRecurseGrabbedLevel[ offi ] & BM_HIGH )
                )
                {
                    baseGrabC* pbgHe = (baseGrabC*)tinP.pPanLifiRecurseGrabbedLevel[ offi ] ;        //U:: THIS IS A BUG: pandle WILL NOT POINT TO A baseGrabC INSTANCE FOR TYPES (grabitC grabotC) OTHER THAN grabC
                    if( !( F(pbgHe->flagsCt) & flBASEgRABc_NOTjEALOUS ) && tinP.pEther )
                    {
                        OStEXT(   ostoJealous , TUCK << 2 ) ;
                        OStEXTAK( ostoJealous , "\r\nHE is jealous of ME because this thread, while holding HIM, is now trying to grab ME.  HE: " ) ;
                        OStEXTC(  ostoJealous , tinP.pPanLifiRecurseGrabbedLevel[offi+2] , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , tinP.pPanLifiRecurseGrabbedLevel[offi+1] ) ;
                        OStEXTAK( ostoJealous , "_9) ct at " ) ;
                        OStEXTC(  ostoJealous , pbgHe->idiFileCt , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , pbgHe->idLineCt ) ;
                        OStEXTAK( ostoJealous , "_9) and grabbed at " ) ;
                        OStEXTC(  ostoJealous , pbgHe->idiFileGrabber , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , pbgHe->idLineGrabber ) ;
                        OStEXTAK( ostoJealous , "_9) in " ) ;
                        OStEXTC(  ostoJealous , pbgHe->idiFileGrabberNote , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , pbgHe->idLineGrabberNote ) ;
                        OStEXTAK( ostoJealous , "_9).  ME: ct at " ) ;
                        OStEXTC(  ostoJealous , idiFileCt , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , idLineCt ) ;
                        OStEXTAK( ostoJealous , "_9) and being grabbed at " ) ;
                        OStEXTC(  ostoJealous , idiFileP , 0 ) ;
                        OStEXTAK( ostoJealous , "(" ) ;
                        OStEXTC9( ostoJealous , idLineP ) ;
                        OStEXTAK( ostoJealous , "_9)\r\n\r\n" ) ;

                        LOGrAW(   ostoJealous ) ;
                        BLAMMO ; //20151117@1854: THIS WAS ADDED WITHOUT ANALYSIS AFTER VERIFYING THAT PRODUCTION CONFIGURATION CAN BE BUILT AND RUN
                    }
                }

                countT idGrabLayerHe = tinP.pPanLifiRecurseGrabbedLevel[ offi + 4 ] ;
                boolT bComplainIf = bOnlyWo
                    ? 1
                    : F(flagsCt) & flBASEgRABc_SHARElAYER
                        ? idGrabLayer <  idGrabLayerHe
                        : idGrabLayer <= idGrabLayerHe
                ;
    
                if( bComplainIf && !( F(flagsP) & flBASEgRABcrEGISTERbEGUN_RECURSING ) )
                {
                    CONoUTcALLnESTsAFE( "nonmonotonic grabbing" ) ;

                    CONoUTrAW3( "\r\n[idAdam]: " , tinP.pAdamGlobal1->idAdam , "\r\n" ) ;
                    LOGrAW3( "\r\n[idAdam]: " , tinP.pAdamGlobal1->idAdam , "\r\n" ) ;

                    CONoUTrAWf( "! error: nonmonotonic grabbing (grab layer decrease attempted [bOnlyWo,lifi,idGrabLayer,lifiHe,idGrabLayerHe]: " , bOnlyWo , "\r\n ME: " , idiFileCt , "(" , idLineCt , ") " , idGrabLayer , " ;\r\n HE: " , tinP.pPanLifiRecurseGrabbedLevel[ offi + 2 ] , "(" , tinP.pPanLifiRecurseGrabbedLevel[ offi + 1 ] , ") " , idGrabLayerHe , "\r\n" ) ;
                    LOGrAWf(    "! error: nonmonotonic grabbing (grab layer decrease attempted [bOnlyWo,lifi,idGrabLayer,lifiHe,idGrabLayerHe]: " , bOnlyWo , "\r\n ME: " , idiFileCt , "(" , idLineCt , ") " , idGrabLayer , " ;\r\n HE: " , tinP.pPanLifiRecurseGrabbedLevel[ offi + 2 ] , "(" , tinP.pPanLifiRecurseGrabbedLevel[ offi + 1 ] , ") " , idGrabLayerHe , "\r\n" ) ;

                    LOGcALLnEST( "nonmonotonic grab call nest:" ) ;

                    BLAMMO ;
                }
            }
        }
    }
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef004.basegrabc.registerbegunf END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef005.basegrabc.registerdonef BEGIN
#define DDNAME       "3func.360ef005.basegrabc.registerdonef"
#define DDNUMB      (countT)0x360ef005
#define IDFILE      (countT)0x1443


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/
/*1*/voidT baseGrabC::registerDoneF( tinS& tinP , const countT idLineP , const countT idiFileP )/*1*/
{
    SCOOP

    _IO_

    if( !( F(flagsCt) & flBASEgRABc_DOnOTrEGISTER ) )
    {
        tinP.monitor.pPanLifiGrabbing[ 2 ] = tinP.monitor.pPanLifiGrabbing[ 1 ] = tinP.monitor.pPanLifiGrabbing[ 0 ] = 0 ;

        const countT pandle = idTypeCt == ifcIDtYPEdERIVEDbASEgRABc_grabC
            ? (countT)this
            : ( (countT)&(byteT&)*(grabitC*)this ) | BM_HIGH
        ;

        const countT offEnd = OFFgRABBEDmAX * 5 ;
        ZE( countT , off ) ;
        for( ; off < offEnd ; off += 5 )
        {
            if( tinP.pPanLifiRecurseGrabbedLevel[ off ] == pandle )
            {
                tinP.pPanLifiRecurseGrabbedLevel[ off + 3 ] ++ ;
                break ;
            }
        }

        if( off == offEnd )
        {
            tinP.monitor.cGrabbed ++ ;

            ZE( countT , off ) ;
            for( ; off < offEnd ; off += 5 )
            {
                if( !tinP.pPanLifiRecurseGrabbedLevel[ off ] )
                {
                    tinP.pPanLifiRecurseGrabbedLevel[ off     ] = pandle   ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 1 ] = idLineP  ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 2 ] = idiFileP ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 3 ] = 0 ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 4 ] = idGrabLayer ;
                    break ;
                }
            }
    
            if( off == offEnd ) { BLAMMO ; }
        }
    }
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef005.basegrabc.registerdonef END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef006.basegrabc.unregisterf BEGIN
#define DDNAME       "3func.360ef006.basegrabc.unregisterf"
#define DDNUMB      (countT)0x360ef006
#define IDFILE      (countT)0x1444


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/
/*1*/voidT baseGrabC::unregisterF( tinS& tinP )/*1*/
{
    SCOOP

    _IO_

    if( !( F(flagsCt) & flBASEgRABc_DOnOTrEGISTER ) )
    {
        const countT pandle = idTypeCt == ifcIDtYPEdERIVEDbASEgRABc_grabC
            ? (countT)this
            : ( (countT)&(byteT&)*(grabitC*)this ) | BM_HIGH
        ;
    
        const countT offEnd = OFFgRABBEDmAX * 5 ;
        ZE( countT , off ) ;
        for( ; off < offEnd ; off += 5 )
        {
            if( tinP.pPanLifiRecurseGrabbedLevel[ off ] == pandle )
            {
                if( tinP.pPanLifiRecurseGrabbedLevel[ off + 3 ] ) tinP.pPanLifiRecurseGrabbedLevel[ off + 3 ] -- ;
                else
                {
                    tinP.monitor.cGrabbed -- ;

                    tinP.pPanLifiRecurseGrabbedLevel[ off + 4 ] = 0 ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 3 ] = 0 ; //20170818@1050: ADDED WITHOUT ANALYSIS
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 2 ] = 0 ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off + 1 ] = 0 ;
                    tinP.pPanLifiRecurseGrabbedLevel[ off     ] = 0 ;
                }
                break ;
            }
        }

        if( off == offEnd )
        {
            LOGrAW11( "baseGrabC::unregisterF/notFoundInTin [pandle,b_grabitC,idLineCt,idiFileCt,idLineGrabber,idiFileGrabber,idLineGrabberNote,idiFileGrabberNote]: " , pandle , "," , idTypeCt == ifcIDtYPEdERIVEDbASEgRABc_grabC , "," , idLineCt , "," , idiFileCt , "," , idLineGrabber , "," , idiFileGrabber , "," , idLineGrabberNote , "," , idiFileGrabberNote , "\r\n" ) ;
            BLAMMO ;
        }
    }
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef006.basegrabc.unregisterf END
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef007.basegrabc.isregisteredf BEGIN
#define DDNAME       "3func.360ef007.basegrabc.isregisteredf"
#define DDNUMB      (countT)0x360ef007
#define IDFILE      (countT)0x1445


//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
// Respecting the rights of other people is an important part of empowering one another.
//

/*
*/
/**/
/*1*/boolT baseGrabC::isRegisteredF( tinS& tinP )/*1*/
{
    SCOOP

    _IO_

    ZE( boolT , bFound ) ;
    if( !( F(flagsCt) & flBASEgRABc_DOnOTrEGISTER ) )
    {
        const countT pandle = idTypeCt == ifcIDtYPEdERIVEDbASEgRABc_grabC
            ? (countT)this
            : ( (countT)&(byteT&)*(grabitC*)this ) | BM_HIGH
        ;
    
        const countT offEnd = OFFgRABBEDmAX * 5 ;
        for( countT off = 0 ; off < offEnd ; off += 5 )
        {
            if( tinP.pPanLifiRecurseGrabbedLevel[ off ] == pandle )
            {
                bFound = 1 ;
                break ;
            }
        }
    }

    return bFound ;
}


//
// Respecting the rights of other people is an important part of empowering one another.
// This proprietary software was crafted at great expense and with great hardship by one man.  It took 28 years.
//
// Copyright (c) 1992-2020 Wo Of Ideafarm.  All rights reserved.  See IDEAFARM.COM for permitted uses.
//

#undef IDFILE
#undef DDNUMB
#undef DDNAME
//SOURCE: \ideafarm.home.1\precious\domains\com\ideafarm\city\library\dictionary\3func.360ef* : 3func.360ef007.basegrabc.isregisteredf END
